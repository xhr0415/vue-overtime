# 前后端交互

通过ajax调用接口，传递参数，使用正确的方法，解析返回值进行页面的渲染，接口的连调

1. 确定接口是否报错
2. 确定传递参数
3. 确定返回值字段，返回值结构

# 前后端分离
在以往的开发模式中，前端就切图就行，写个点击啥的效果。页面的数据渲染，都是由后端完成，但是这个过程中，后端工作量大，效率低。
而前后端分离其实就是解脱后端，提升前端的价值（有了业务）
前后端分离
后端：接口开发
前端：页面布局，动态效果，数据渲染，逻辑控制
沟通称为，前后端沟通（接口连调） 报错就问，问后端

# 前后分离后，接口规范
如果后端提供接口没有一定规范，那么前端操作非常复杂，所以一般公司都会一定接口规范（约定）
* 地址
* 方法
* 状态码
* 返回值的格式

最常用的接口个规范就是RESTful API  RESTful 是目前最流行的 API 设计规范，用于 Web 数据接口的设计。


## URL 设计
一个地址，多个方法，做不同的操作， 动词（http请求方法） + 宾语（一个名字）

### 5种http请求方法
* get  获取数据
* post  发送数据（新增）
* PUT  整体更新
* PATCH  通常是部分更新
* DELETE  删除数据

对应的就是crud（增删改查）

## 状态码
服务给客户端响应的状态

HTTP 状态码就是一个三位数，分成五个类别。
```
  1xx：相关信息   忽略
  2xx：操作成功   统统都是成功
  3xx：重定向     接口请求中不常见，一般体现在资源请求
  4xx：客户端错误  客户端错误（参数错误，类型错误，方法错误，服务端错误）
  5xx：服务器错误  服务端错误（也可能是网络错误，也可能是客户端错误）
```

### 请求成功的状态码( 2XX ):
```
  200: 服务器成功返回用户请求的数据，该操作是幂等的，一般用于 
  201: 服务器新建或修改数据成功
  202: 服务器成功表示一个请求已经进入处理队列(异步任务)
  204: 服务器成功处理了请求，但没有返回任何内容
```

### 4xx 状态码  客户端错误
4xx状态码表示客户端错误，主要有下面几种。
```
  400 Bad Request：请求有错误

  401 Unauthorized：未登录。

  403 Forbidden：没有权限。

  404 Not Found：所请求的资源不存在，或不可用。

  405 Method Not Allowed：没有权限。

  410 Gone：所请求的资源已从这个地址转移，不再可用。

  415 Unsupported Media Type：客户端要求的返回格式不支持。比如，API 只能返回 JSON 格式，但是客户端要求返回 XML 格式。

  422 Unprocessable Entity ：客户端上传的附件无法处理，导致请求失败。

  429 Too Many Requests：客户端的请求次数超过限额。
```

### 5xx 状态码
5xx状态码表示服务端错误。一般来说，API 不会向用户透露服务器的详细信息，所以只要两个状态码就够了。
```
500 Internal Server Error：客户端请求有效，服务器处理时发生了意外。

503 Service Unavailable：服务器无法处理请求，一般用于网站维护状态。
```

## 响应内容
一般需要json格式

如果错误需要返回固定格式，便于前端做统一错误处理

失败时返回的格式是统一的的，主要包含以下几个值:
name: 错误名称代码
message: 错误的具体消息
code: 错误名称子代码，大部分情况下都为 0 ，保留使用
```
{
  "name" : "ValidateException",
  "message" : "姓名不能为空",
  "code" : 0
}
```

### 错误名称代码
* BadRequest: 请求错误
* ValidateFail: 数据验证失败 
* Unauthorized: 身份验证失败
* Forbidden: 禁止访问
* NotFound: 请求的资源未找到


### 接口调试
接口调试可以使用一些工具，postman  apizz ....
但是在做接口连调的时候，ajax是从浏览器发出的，

在浏览器中network的xhr中看到所有的请求，我们需要分析`报文`（请求头，响应头，参数，返回值）来分析接口的正确

